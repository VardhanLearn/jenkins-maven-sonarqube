pipeline {
    
    agent any
    
      stages {
        stage ('Git-Checkout') {
            
            steps {
                
                git branch: 'main',
                url: 'https://github.com/VardhanLearn/jenkins-maven-sonarqube.git'
                
            }
        }  
        
        stage ('Maven-Build') {
             
             steps {
                
                sh 'mvn clean package'   
             }
        }
             
             
	    stage ('sonar') {
	        
	        steps {
	            
	            withSonarQubeEnv ('sonar') {
	             
	             sh 'mvn sonar:sonar' 
	             
	            }
	        }
	    }
    }    
             post {
	          success {
	              echo 'Now Archiving it'
	              archiveArtifacts artifacts: '**/*.jar'
	           }
	        }
}
	        
